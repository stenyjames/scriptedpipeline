node("Jenkins-Slave-Centos7-VM") {
   
   stage("Print cwd") {
      sh "pwd" 
      sh "id"
   }
   
   stage("Build Docker Centos 7 image") {
      echo "Building docker image"
      checkout([$class: 'GitSCM',
        branches: [[name: "origin/master"]],
		gitTool: 'git-slave', 
		userRemoteConfigs: [[
		url: 'https://github.com/stenyjames/scriptedpipeline.git' ]]
		])
		
      def centosImage = docker.build("stenyjames/devops-centos7:latest", "./docker-image-build")
      
      centosImage.inside {
         sh "hostname"
      }
   }

	
stage("Push Docker Centos 7 image") {
      echo "Pushing newly created docker image"
	docker.withRegistry("https://registry.hub.docker.com","docker-hub-credentials") {
		//centosImage.push("${env.BUILD_NUMBER}")
		//centosImage.push("stenyjames/devops-centos7:latest")
		centosImage.push()
	}
      }
   
 


}
